Vercel formato:

export default async function handler(req, res) {
  // cÃ³digo
}
3. ConfiguraÃ§Ã£o Vercel
Criado vercel.json:

{
  "buildCommand": "npm run build",
  "outputDirectory": "dist/public",
  "functions": {
    "api/*.js": { "maxDuration": 30 }
  },
  "rewrites": [
    {
      "source": "/((?!api|assets|.*\\.).*)$",
      "destination": "/index.html"
    }
  ]
}
ğŸ—ï¸ Build Configuration
1. Estrutura de Build
Frontend: React + Vite â†’ dist/public/
Backend: Express server â†’ dist/index.js
APIs: Serverless functions â†’ api/
2. Scripts de Build
{
  "build": "vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist"
}
ğŸ’³ IntegraÃ§Ã£o API PIX (For4Payments)
1. API de CriaÃ§Ã£o PIX (api/create-pix-payment.js)
// Recebe dados do checkout
const { nome, cpf, email, telefone, amount, items } = req.body;
// Monta payload For4Payments
const pixData = {
  customer: {
    name: nome,
    email: email,
    document: cpf.replace(/\D/g, ''),
    phone: telefone.replace(/\D/g, '')
  },
  billing: {
    name: nome,
    address: {
      country: "br",
      state: estado,
      city: cidade,
      zipcode: cep.replace(/\D/g, ''),
      street: logradouro,
      number: numero,
      neighborhood: bairro,
      complement: complemento
    }
  },
  items: items,
  payment: {
    method: "pix"
  }
};
// Chama API For4Payments
const response = await fetch("https://app.for4payments.com.br/api/v1/charge", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "Authorization": process.env.FOR4PAYMENTS_API_KEY
  },
  body: JSON.stringify(pixData)
});
2. Webhook Handler (api/webhook-for4payments.js)
// Recebe notificaÃ§Ãµes de pagamento
const webhookData = req.body;
const eventType = webhookData.event;
const transactionStatus = webhookData.status;
// Processa diferentes tipos de evento
switch(eventType) {
  case 'charge.paid':
    // Pagamento aprovado
    break;
  case 'charge.refunded':
    // Estorno
    break;
}
3. ConfiguraÃ§Ã£o AutomÃ¡tica de Webhook
const webhookData = {
  callbackUrl: `https://${req.headers.host}/api/webhook-for4payments`,
  name: "SaboresDeMinas Webhook",
  onBuyApproved: true,
  onRefound: true,
  onChargeback: true,
  onPixCreated: true
};
ğŸ› ï¸ CorreÃ§Ãµes Implementadas
1. Campo CPF ObrigatÃ³rio
Problema: Checkout nÃ£o coletava CPF
SoluÃ§Ã£o: Adicionado campo CPF com validaÃ§Ã£o completa

interface FormData {
  nome: string;
  cpf: string; // â† Adicionado
  telefone: string;
  email: string;
  endereco: Address;
}
2. ValidaÃ§Ã£o de CPF
const validateCPF = (cpf: string): boolean => {
  const cleanCPF = cpf.replace(/\D/g, '');
  // ValidaÃ§Ã£o completa com dÃ­gitos verificadores
};
3. Loop de Redirect
Problema: ERR_TOO_MANY_REDIRECTS
SoluÃ§Ã£o: Trocado redirects por rewrites no vercel.json

4. Tracking TikTok Pixel
Adicionado pixel de conversÃ£o no client/index.html:

<script>
ttq.load('D16ED2JC77U8BG0G8KCG');
ttq.page();
</script>
ğŸ”— Fluxo Completo do PIX
UsuÃ¡rio preenche checkout â†’ Nome, CPF, email, telefone, endereÃ§o
Frontend valida dados â†’ CPF, email, CEP
Envia para API â†’ POST /api/create-pix-payment
API For4Payments â†’ Gera QR Code e cÃ³digo PIX
Retorna para usuÃ¡rio â†’ QR Code + cÃ³digo copiÃ¡vel
Webhook notifica â†’ Quando pagamento Ã© confirmado
ğŸ“ Arquivos Modificados
vercel.json - ConfiguraÃ§Ã£o de deploy
api/ - 4 functions convertidas do Netlify
client/src/components/Checkout.tsx - Campo CPF adicionado
client/index.html - TikTok Pixel
README.md - DocumentaÃ§Ã£o atualizada
.gitignore - Configurado para Vercel
ğŸš€ Resultado Final
âœ… Deploy automÃ¡tico no Vercel
âœ… APIs PIX funcionais
âœ… Webhook configurado automaticamente
âœ… CPF obrigatÃ³rio no checkout
âœ… ValidaÃ§Ã£o completa dos dados
âœ… Tracking TikTok ativo
âœ… Zero configuraÃ§Ã£o manual necessÃ¡ria
O projeto agora estÃ¡ 100% otimizado para Vercel com integraÃ§Ã£o PIX completa e funcional!